<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> <!-- Set the character encoding for the document -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Ensure proper rendering and touch zooming on mobile devices -->
    <title>Add Claim - Budget Claims System</title> <!-- Title of the document -->
    <link rel="stylesheet" href="/css/styles.css"> <!-- Link to external CSS for styling -->
</head>
<body>
    <header>
        <img src="/images/Budget_logo.svg" alt="Budget Logo" class="logo"> <!-- Company logo -->
        <h1>Budget Claims System</h1> <!-- Main heading -->
        <nav>
            <ul>
                <li><a href="/dashboard">Dashboard</a></li> <!-- Link to Dashboard -->
                <li class="Claims">
                    <a href="javascript:void(0)" class="dropbtn">Claims</a> <!-- Dropdown trigger -->
                    <div class="dropdown-content">
                        <a href="/claims/search">Search Claims</a> <!-- Link to Search Claims -->
                        <a href="/claims/add">Add Claim</a> <!-- Link to Add Claim -->
                    </div>
                </li>
                <li><a href="/reports">Reports</a></li> <!-- Link to Reports -->
                <li class="Settings">
                    <a href="javascript:void(0)" class="dropbtn">Settings</a> <!-- Dropdown trigger -->
                    <div class="dropdown-content">
                        <a href="/general-settings">General Settings</a> <!-- Link to General Settings -->
                        <a href="/user-management">User Management</a> <!-- Link to User Management -->
                        <a href="/email-templates">Email Templates</a> <!-- Link to Email Templates -->
                    </div>
                </li>
                <li><a href="/help">Help</a></li> <!-- Link to Help -->
                <li><a href="/logout">Logout</a></li> <!-- Link to Logout -->
            </ul>
        </nav>
    </header>
    <main>
        <div class="container">
            <h2>Add Claim</h2> <!-- Section heading -->
            <form action="/claims" method="POST" enctype="multipart/form-data"> <!-- Form to add a new claim -->
                <% if (typeof fileErrors !== 'undefined' && fileErrors.length > 0) { %>
                    <div class="error-banner">
                        <h3>File Upload Errors:</h3>
                        <ul>
                            <% fileErrors.forEach(error => { %>
                                <li><%= error %></li>
                            <% }); %>
                        </ul>
                    </div>
                <% } %>

                <div class="tab-container">
                    <div class="tab-buttons">
                        <button type="button" class="tablinks" id="defaultOpen" data-tab="CustomerInfo">Customer Information</button>
                        <button type="button" class="tablinks" data-tab="VehicleInfo">Vehicle Information</button>
                        <button type="button" class="tablinks" data-tab="ClaimDetails">Claim Details</button>
                        <button type="button" class="tablinks" data-tab="InsuranceInfo">Insurance Information</button>
                    </div>

                    <!-- Tab content -->
                    <div id="CustomerInfo" class="tabcontent">
                        <div class="claim-info">
                            <label for="customerName">Customer Name:</label>
                            <input type="text" id="customerName" name="customerName">
                            <span class="error-message" id="errorCustomerName"></span>

                            <label for="customerNumber">Customer Number:</label>
                            <input type="text" id="customerNumber" name="customerNumber">
                            <span class="error-message" id="errorCustomerNumber"></span>

                            <label for="customerEmail">Customer Email:</label>
                            <input type="email" id="customerEmail" name="customerEmail">
                            <span class="error-message" id="errorCustomerEmail"></span>

                            <label for="customerAddress">Customer Address:</label>
                            <input type="text" id="customerAddress" name="customerAddress">
                            <span class="error-message" id="errorCustomerAddress"></span>

                            <label for="customerDriversLicense">Customer Drivers License:</label>
                            <input type="text" id="customerDriversLicense" name="customerDriversLicense">
                            <span class="error-message" id="errorCustomerDriversLicense"></span>
                        </div>
                    </div>

                    <div id="VehicleInfo" class="tabcontent">
                        <div class="claim-info">
                            <label for="carMake">Car Make:</label>
                            <input type="text" id="carMake" name="carMake">
                            <span class="error-message" id="errorCarMake"></span>

                            <label for="carModel">Car Model:</label>
                            <input type="text" id="carModel" name="carModel">
                            <span class="error-message" id="errorCarModel"></span>

                            <label for="carYear">Car Year:</label>
                            <input type="text" id="carYear" name="carYear">
                            <span class="error-message" id="errorCarYear"></span>

                            <label for="carColor">Car Color:</label>
                            <input type="text" id="carColor" name="carColor">
                            <span class="error-message" id="errorCarColor"></span>

                            <label for="carVIN">Car VIN:</label>
                            <input type="text" id="carVIN" name="carVIN">
                            <span class="error-message" id="errorCarVIN"></span>

                            <label for="vehicleOdometer">Vehicle Odometer:</label>
                            <input type="number" id="vehicleOdometer" name="vehicleOdometer">
                            <span class="error-message" id="errorVehicleOdometer"></span>

                            <label for="accidentDate">Accident Date:</label>
                            <input type="date" id="accidentDate" name="accidentDate">
                            <span class="error-message" id="errorAccidentDate"></span>
                        </div>
                    </div>

                    <div id="ClaimDetails" class="tabcontent">
                        <div class="claim-info">
                            <label for="mva">MVA:</label>
                            <input type="text" id="mva" name="mva">
                            <span class="error-message" id="errorMVA"></span>

                            <label for="raNumber">RA Number:</label>
                            <input type="text" id="raNumber" name="raNumber">
                            <span class="error-message" id="errorRANumber"></span>

                            <label for="damagesTotal">Damages Total:</label>
                            <input type="text" id="damagesTotal" name="damagesTotal">
                            <span class="error-message" id="errorDamagesTotal"></span>

                            <label for="billable">Billable:</label>
                            <select id="billable" name="billable">
                                <option value="true">Yes</option>
                                <option value="false">No</option>
                                <option value="n/a">N/A</option>
                                <option value="unknown">Unknown</option>
                            </select>
                            <span class="error-message" id="errorBillable"></span>

                            <label for="isRenterAtFault">Is Renter At Fault:</label>
                            <select id="isRenterAtFault" name="isRenterAtFault">
                                <option value="true">Yes</option>
                                <option value="false">No</option>
                                <option value="n/a">N/A</option>
                                <option value="unknown">Unknown</option>
                            </select>
                            <span class="error-message" id="errorIsRenterAtFault"></span>

                            <label for="damageType">Damage Type:</label>
                            <div id="damageTypeContainer">
                                <% damageTypes.forEach(damageType => { %>
                                <label>
                                    <input type="checkbox" name="damageType" value="<%= damageType._id %>" <%= claim.damageType && claim.damageType.includes(damageType._id.toString()) ? 'checked' : '' %>>
                                    <%= damageType.name %>
                                </label>
                                <% }) %>
                            </div>
                            <label for="status">Status:</label>
                            <select id="status" name="status">
                                <% statuses.forEach(status => { %>
                                <option value="<%= status._id %>" <%= claim.status && claim.status.toString() === status._id.toString() ? 'selected' : '' %>><%= status.name %></option>
                                <% }) %>
                            </select>
                        </div>    
                    </div>

                    <div id="InsuranceInfo" class="tabcontent">
                        <div class="claim-info">
                            <label for="insuranceCarrier">Insurance Carrier:</label>
                            <input type="text" id="insuranceCarrier" name="insuranceCarrier">
                            <span class="error-message" id="errorInsuranceCarrier"></span>

                            <label for="insuranceAdjuster">Insurance Adjuster:</label>
                            <input type="text" id="insuranceAdjuster" name="insuranceAdjuster">
                            <span class="error-message" id="errorInsuranceAdjuster"></span>

                            <label for="insuranceEmail">Insurance Email:</label>
                            <input type="email" id="insuranceEmail" name="insuranceEmail">
                            <span class="error-message" id="errorInsuranceEmail"></span>

                            <label for="insurancePhoneNumber">Insurance Phone Number:</label>
                            <input type="text" id="insurancePhoneNumber" name="insurancePhoneNumber">
                            <span class="error-message" id="errorInsurancePhoneNumber"></span>

                            <label for="insuranceFaxNumber">Insurance Fax Number:</label>
                            <input type="text" id="insuranceFaxNumber" name="insuranceFaxNumber">
                            <span class="error-message" id="errorInsuranceFaxNumber"></span>

                            <label for="insuranceAddress">Insurance Address:</label>
                            <input type="text" id="insuranceAddress" name="insuranceAddress">
                            <span class="error-message" id="errorInsuranceAddress"></span>

                            <label for="insurancePolicyNumber">Insurance Policy Number:</label>
                            <input type="text" id="insurancePolicyNumber" name="insurancePolicyNumber">
                            <span class="error-message" id="errorInsurancePolicyNumber"></span>

                            <label for="insuranceClaimNumber">Insurance Claim Number:</label>
                            <input type="text" id="insuranceClaimNumber" name="insuranceClaimNumber">
                            <span class="error-message" id="errorInsuranceClaimNumber"></span>
                        </div>
                    </div>
                </div>

                <!-- Button group -->
                <div class="button-group">
                    <button type="submit" class="btn">Add Claim</button>
                    <a href="/claims" class="btn">Cancel</a>
                </div>
            </form>
        </div>
    </main>

    <!-- Toast notifications for success and error messages -->
    <div id="toast" class="toast"></div>

    <script src="/js/add_claim.js">
        document.querySelector('form').addEventListener('submit', function(e) {
    const fileInputs = document.querySelectorAll('input[type="file"]');
    let hasFiles = false;
    
    fileInputs.forEach(input => {
        if (input.files.length > 0) {
            hasFiles = true;
            console.log(`Files selected for ${input.name}:`, input.files);
        }
    });
    
    if (hasFiles) {
        console.log('Form submitted with files');
    }
});
    </script>
</body>
</html>